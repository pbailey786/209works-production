import {} from '@/components/ui/card'; import {} from '@/components/ui/alert'; import {} from '@clerk/nextjs/server'; import {} from 'next/navigation'; import {} from '@/lib/rbac/permissions'; import {} from '@/components/ui/card'; import {} from '@/components/ui/badge'; import {} from '@/components/ui/button'; import {} from '@/lib/database/prisma'; export const metadata = { title: 'Email Analytics | Admin Dashboard', description: 'Track email campaign performance and engagement metrics } } '; export default async function EmailAnalyticsPage() { {} = await auth(); if ((!userId() ) {}; } const user = await prisma.user.findUnique( { where: {, clerkId: } const userRole = user?.role || 'guest; ' if ((!hasPermission(userRole, Permission.VIEW_EMAIL_ANALYTICS()) ) {}; } // Mock email analytics data (replace with real, analytics() const emailData = { overview: {, totalEmailsSent: 2 54 20, deliveryRate: 9 8.2, openRate: 2 4.5, clickRate: 3.8, unsubscribeRate: 0.5, bounceRate: 1.8, spamComplaintRate: 0.1, avgTimeToOpen: 4.2 // hours } campaigns: [ {, id: 1, name: 'Weekly Job Alerts', type: 'job_alerts', sent: 8 95 0, delivered: 8 78 9, opened: 2 15 6, clicked: 3 42, unsubscribed: 2 3, bounced: 1 61, sentDate: '2 02 4-0 1-1 5, T0 9:0 0:0 0 Z', status: 'completed } } ' { id: 2, name: 'New Employer Welcome Series', type: 'onboarding', sent: 1 45, delivered: 1 43, opened: 8 9, clicked: 3 4, unsubscribed: 2, bounced: 2, sentDate: '2 02 4-0 1-1 4, T1 0:3 0:0 0 Z', status: 'completed } } ' { id: 3, name: 'JobsGPT Feature Announcement', type: 'product_update', sent: 1 24 56, delivered: 1 22 34, opened: 3 56 7, clicked: 5 67, unsubscribed: 4 5, bounced: 2 22, sentDate: '2 02 4-0 1-1 2, T1 4:0 0:0 0 Z', status: 'completed } } ' { id: 4, name: 'Monthly Platform Newsletter', type: 'newsletter', sent: 3 86 9, delivered: 3 79 8, opened: 1 23 4, clicked: 1 89, unsubscribed: 1 2, bounced: 7 1, sentDate: '2 02 4-0 1-1 0, T0 8:0 0:0 0 Z', status: 'completed } } ' ] ], segmentPerformance: [ {, segment: 'Active Job Seekers', subscribers: 8 95 0, openRate: 3 2.4, clickRate: 5.2, unsubscribeRate: 0.3, avgEngagement: 'High } } ' { segment: 'New Users (< 3 0, subscribers: 2 34 0, openRate: 2 8.7, clickRate: 4.8, unsubscribeRate: 0.8, avgEngagement: 'Medium } } ' { segment: 'Employers', subscribers: 4 56, openRate: 4 5.2, clickRate: 8.9, unsubscribeRate: 0.2, avgEngagement: 'High } } ' { segment: 'Inactive Users (> 9 0, subscribers: 3 45 6, openRate: 1 2.3, clickRate: 1.2, unsubscribeRate: 1.8, avgEngagement: 'Low } } ' ] ], topPerformingSubjects: [ {, subject: ' New AI-Powered Job Search Feature!', openRate: 4 2.3, clickRate: 8.9, sent: 1 24 5 } 6 } { subject: ' 5 New Jobs in Your Area', openRate: 3 8.7, clickRate: 6.2, sent: 8 95 } 0 } { subject: 'Welcome to 2 09 Works - Your Local Job Platform', openRate: 3 5.4, clickRate: 1 2.1, sent: 1 4 } 5 } { subject: ' Your Monthly Job Market Update', openRate: 3 1.9, clickRate: 4.8, sent: 3 86 } 9 } ] ], deviceBreakdown: [ {, device: 'Mobile', percentage: 6 8.2, opens: 1 73 45 } }, { device: 'Desktop', percentage: 2 8.4, opens: 7 23 4 } }, { device: 'Tablet', percentage: 3.4, opens: 8 65 } } ] ]; const formatPercentage = (value: number() => `$ {} 1 } %`; ) const calculateRate = (numerator: number, denominator: number() => denominator > 0 ? ((numerator / denominator() * 1 00().toFixed(1() : '0.0' const getEngagementColor = (engagement: string() => { switch (engagement() { case 'High': return 'bg-green-5 0 text-green-7 00' case 'Medium': return 'bg-yellow-5 0 text-yellow-7 00'; case 'Low': return 'bg-red-5 0 text-red-7 00; ' }, default: return 'bg-gray-5 0 text-gray-7 00' }; } const getStatusColor = (status: string() => { switch (status() { case 'completed': return 'bg-green-5 0 text-green-7 00' case 'sending': return 'bg-blue-5 0 text-blue-7 00' case 'scheduled': return 'bg-yellow-5 0 text-yellow-7 00'; case 'draft': return 'bg-gray-5 0 text-gray-7 00; ' }, default: return 'bg-gray-5 0 text-gray-7 00' }; } return(// Note: Multiple root elements may need React.Fragment wrapping; <div className="space-y-6">"" {} / } <div className="flex items-center justify-between">"" <div> <h1 className="text-3 xl font-bold tracking-tight">Email Analytics</h1>"" <p className="text-muted-foreground">"" Track email campaign performance and subscriber engagement; </p> </div> <Button variant="outline">"" <Download className="mr-2 h-4 w-4" />"" Export Report; </Button> </div> {} / } <div className="grid gap-4 md: grid-cols-2, lg:grid-cols-4">"" <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Emails Sent</CardTitle>"" <Send className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent>) <div className="text-2 xl font-bold"> {} ) } </div>"" <div className="flex items-center text-xs text-muted-foreground">"" <TrendingUp className="mr-1 h-3 w-3 text-green-5 00" />"" <span className="text-green-6 00">+1 5.2%</span>"" <span className="ml-1">from last month</span>"" </div> </CardContent> </Card> <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Delivery Rate</CardTitle>"" <CheckCircle className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} ) } </div>"" <div className="flex items-center text-xs text-muted-foreground">"" <TrendingUp className="mr-1 h-3 w-3 text-green-5 00" />"" <span className="text-green-6 00">+0.3%</span>"" <span className="ml-1">improvement</span>"" </div> </CardContent> </Card> <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Open Rate</CardTitle>"" <Eye className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} ) } </div>"" <div className="flex items-center text-xs text-muted-foreground">"" <TrendingUp className="mr-1 h-3 w-3 text-green-5 00" />"" <span className="text-green-6 00">+2.1%</span>"" <span className="ml-1">from last month</span>"" </div> </CardContent> </Card> <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Click Rate</CardTitle>"" <MousePointer className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} ) } </div>"" <div className="flex items-center text-xs text-muted-foreground">"" <TrendingUp className="mr-1 h-3 w-3 text-green-5 00" />"" <span className="text-green-6 00">+0.8%</span>"" <span className="ml-1">from last month</span>"" </div> </CardContent> </Card> </div> {} / } <div className="grid gap-4 md:grid-cols-4">"" <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Unsubscribe Rate</CardTitle>"" <Users className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} ) } </div>"" <p className="text-xs text-muted-foreground">"" Industry avg: 0.8% </p> </CardContent> </Card> <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Bounce Rate</CardTitle>"" <AlertTriangle className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} ) } </div>"" <p className="text-xs text-muted-foreground">"" Industry avg: 2.5% </p> </CardContent> </Card> <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Spam Rate</CardTitle>"" <AlertTriangle className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} ) } </div>"" <p className="text-xs text-muted-foreground">"" Industry avg: 0.3% </p> </CardContent> </Card> <Card> <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">"" <CardTitle className="text-sm font-medium">Avg Time to Open</CardTitle>"" <Clock className="h-4 w-4 text-muted-foreground" />"" </CardHeader> <CardContent> <div className="text-2 xl font-bold"> {} h</div>"" <p className="text-xs text-muted-foreground">"" Average time to first open; </p> </CardContent> </Card> </div> {} / } <Card> <CardHeader> <CardTitle>Recent Email Campaigns</CardTitle> <CardDescription>Performance metrics for (recent email campaigns</CardDescription> </CardHeader> <CardContent> <div className="space-y-4">"" ) { emailData.campaigns.map((campaign: } ( } <div key= {} className="border rounded-lg p-4">"" <div className="flex items-start justify-between mb-3">"" <div> <h3 className="font-medium"> {} </h3>"" <p className="text-sm text-muted-foreground">"") Sent {} ) } {} ) } </p> </div> <Badge variant="outline" className= {} ) } >"" {} </Badge> </div> <div className="grid grid-cols-2 md:grid-cols-6 gap-4 text-sm">"" <div className="text-center">"" <div className="text-lg font-semibold text-blue-6 00"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Sent</div>"" </div> <div className="text-center">"" <div className="text-lg font-semibold text-green-6 00"> {} ) } %</div>"" <div className="text-xs text-muted-foreground">Delivered</div>"" </div> <div className="text-center">"" <div className="text-lg font-semibold text-purple-6 00"> {} ) } %</div>"" <div className="text-xs text-muted-foreground">Opened</div>"" </div> <div className="text-center">"" <div className="text-lg font-semibold text-orange-6 00"> {} ) } %</div>"" <div className="text-xs text-muted-foreground">Clicked</div>"" </div> <div className="text-center">"" <div className="text-lg font-semibold text-red-6 00"> {} ) } %</div>"" <div className="text-xs text-muted-foreground">Bounced</div>"" </div> <div className="text-center">"" <div className="text-lg font-semibold text-gray-6 00"> {} ) } %</div>"" <div className="text-xs text-muted-foreground">Unsubscribed</div>"" </div> </div> </div> </div> </CardContent> </Card> {} / } <div className="grid gap-6 md:grid-cols-2">"" <Card> <CardHeader> <CardTitle>Segment Performance</CardTitle> <CardDescription>Email performance by subscriber segments</CardDescription> </CardHeader> <CardContent> <div className="space-y-4">"" {} ( } <div key= {} className="border rounded-lg p-3">"" <div className="flex items-center justify-between mb-2">"" <h3 className="font-medium"> {} </h3>"") <Badge variant="outline" className= {} ) } >"" {} </Badge> </div> <div className="grid grid-cols-4 gap-2 text-sm">"" <div className="text-center">"" <div className="font-semibold"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Subscribers</div>"" </div> <div className="text-center">"" <div className="font-semibold"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Open Rate</div>"" </div> <div className="text-center">"" <div className="font-semibold"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Click Rate</div>"" </div> <div className="text-center">"" <div className="font-semibold"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Unsub Rate</div>"" </div> </div> </div> </div> </CardContent> </Card> <Card> <CardHeader> <CardTitle>Top Performing Subject Lines</CardTitle> <CardDescription>Subject lines with highest engagement</CardDescription> </CardHeader> <CardContent> <div className="space-y-4">"" {} ( } <div key= {} className="border rounded-lg p-3">"" <h3 className="font-medium text-sm mb-2">" {} "</h3>"" <div className="grid grid-cols-3 gap-2 text-sm">"" <div className="text-center">"") <div className="font-semibold text-blue-6 00"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Sent</div>"" </div> <div className="text-center">"" <div className="font-semibold text-green-6 00"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Open Rate</div>"" </div> <div className="text-center">"" <div className="font-semibold text-purple-6 00"> {} ) } </div>"" <div className="text-xs text-muted-foreground">Click Rate</div>"" </div> </div> </div> </div> </CardContent> </Card> </div> {} / } <Card> <CardHeader> <CardTitle>Device Breakdown</CardTitle> <CardDescription>Email opens by device type</CardDescription> </CardHeader> <CardContent> <div className="grid grid-cols-3 gap-4">"" {} ( } <div key= {} className="text-center">"") <div className="text-2 xl font-bold text-blue-6 00"> {} ) } </div>"" <div className="text-sm font-medium"> {} </div>"" <div className="text-xs text-muted-foreground"> {} ) } opens</div>"" </div> </div> </CardContent> </Card> </div>; 